$(function () {
  // "use strict";

  $(".preloader").fadeOut();
  // ==============================================================
  // Theme options
  // ==============================================================
  // ==============================================================
  // sidebar-hover
  // ==============================================================

  $(".left-sidebar").hover(
    function () {
      $(".navbar-header").addClass("expand-logo");
    },
    function () {
      $(".navbar-header").removeClass("expand-logo");
    }
  );
  // this is for close icon when navigation open in mobile view
  $(".nav-toggler").on("click", function () {
    $("#main-wrapper").toggleClass("show-sidebar");
    $(".nav-toggler i").toggleClass("ti-menu");
  });
  $(".nav-lock").on("click", function () {
    $("body").toggleClass("lock-nav");
    $(".nav-lock i").toggleClass("mdi-toggle-switch-off");
    $("body, .page-wrapper").trigger("resize");
  });
  $(".search-box a, .search-box .app-search .srh-btn").on("click", function () {
    $(".app-search").toggle(200);
    $(".app-search input").focus();
  });

  // ==============================================================
  // Right sidebar options
  // ==============================================================
  $(function () {
    $(".service-panel-toggle").on("click", function () {
      $(".customizer").toggleClass("show-service-panel");
    });
    $(".page-wrapper").on("click", function () {
      $(".customizer").removeClass("show-service-panel");
    });
  });
  // ==============================================================
  // This is for the floating labels
  // ==============================================================
  $(".floating-labels .form-control")
    .on("focus blur", function (e) {
      $(this)
        .parents(".form-group")
        .toggleClass("focused", e.type === "focus" || this.value.length > 0);
    })
    .trigger("blur");

  // ==============================================================
  //tooltip
  // ==============================================================
  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });
  // ==============================================================
  //Popover
  // ==============================================================
  $(function () {
    $('[data-toggle="popover"]').popover();
  });

  // ==============================================================
  // Perfact scrollbar
  // ==============================================================
  $(".message-center, .customizer-body, .scrollable").perfectScrollbar({
    wheelPropagation: !0,
  });

  /*var ps = new PerfectScrollbar('.message-body');
    var ps = new PerfectScrollbar('.notifications');
    var ps = new PerfectScrollbar('.scroll-sidebar');
    var ps = new PerfectScrollbar('.customizer-body');*/

  // ==============================================================
  // Resize all elements
  // ==============================================================
  $("body, .page-wrapper").trigger("resize");
  $(".page-wrapper").show();
  // ==============================================================
  // To do list
  // ==============================================================
  $(".list-task li label").click(function () {
    $(this).toggleClass("task-done");
  });

  //****************************
  /* This is for the mini-sidebar if width is less then 1170*/
  //****************************
  var setsidebartype = function () {
    var width = window.innerWidth > 0 ? window.innerWidth : this.screen.width;
    if (width < 1170) {
      $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
    } else {
      $("#main-wrapper").attr("data-sidebartype", "full");
    }
  };
  $(window).ready(setsidebartype);
  $(window).on("resize", setsidebartype);
  //****************************
  /* This is for sidebartoggler*/
  //****************************
  $(".sidebartoggler").on("click", function () {
    $("#main-wrapper").toggleClass("mini-sidebar");
    if ($("#main-wrapper").hasClass("mini-sidebar")) {
      $(".sidebartoggler").prop("checked", !0);
      $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
    } else {
      $(".sidebartoggler").prop("checked", !1);
      $("#main-wrapper").attr("data-sidebartype", "full");
    }
  });


    //*************************************************************************************
  /////////// category.html*
  //*************************************************************************************
//******************************* ajax function for view category ***********************************//
$("#inside_cat-div").on("click", "#view_category", function () {
  let id = $(this).attr("data-sid");
  console.log(id);
  mydata = { sid: id };

  var dataToSend = id;
  var targetPage = "languages.html";

  window.location.href =
    targetPage + "?data=" + encodeURIComponent(dataToSend);
});

function category_view() {
  var dataReceived = decodeURIComponent(window.location.search.split("=")[1]);
  let language_id = dataReceived;
  let mydata = { id: language_id };
  console.log(mydata);

  $.ajax({
    url: "../../backhend/category_backhend.php/category_name.php",
    type: "POST",
    data: JSON.stringify(mydata),

    success: function (data) {
      console.log("function is scucess");
      $("#category-name").html(data);
    },
    error: function () {
      console.log("function is fail");
    },
  });
  
  
  $.ajax({
    url: "../../backhend/category_backhend.php/view_button.php",
    type: "POST",
    data: JSON.stringify(mydata),

    success: function (data) {
      console.log("function is scucess");
      $("#inside_lan-div").html(data);
    },
    error: function () {
      console.log("function is fail");
    },
  });
}
category_view();
    //******************************* ajax function for view category in language.html ***********************************//
    $("#option_cat").change(function () {
      alert("SDFSdfsdfsdfs");
          $.ajax({
            url: "../../backhend/category_backhend/retrive_cat_option.php",
            type: "POST",
            data: JSON.stringify(mydata),
      
            success: function (data) {
              console.log(data);
              $("#option_cat").html(data);
            },
            error: function () {
              alert("error");
            },
          });
        });

    

  //*************************************************************************************
  /////////// languages.html*
  //*************************************************************************************

  //******************************* Toggle to add language or add language ***********************************//
  $("#lan-btn").click(function () {
    document.getElementById("dialog").style.visibility = "visible";
    $("#dialog").toggle();
  });

  //******************************* ajax function for retrive language ***********************************//
  function showlanguage() {
    $.ajax({
      url: "../../backhend/retrive.php",
      type: "GET",

      success: function (data) {
        $("#inside_lan-div").html(data);
      },
      error: function () {
        console.log("function is fail");
      },
    });
  }

  //******************************* ajax function for add language ***********************************//
  $("#add").click(function (e) {
    e.preventDefault();
    console.log("button pressed by you");
    let language = $("#input_of_language_name").val();
    var dataReceived = decodeURIComponent(window.location.search.split("=")[1]);
    let language_id = dataReceived;
    let mydata = { id: language_id, language_name: language};
    console.log(mydata);
    $.ajax({
      url: "../../backhend/insert.php",
      data: JSON.stringify(mydata),
      type: "POST",

      success: function (data) {
        // console.log("data saved sucessfully in database");
        if (data === "Language added sucessfully") {
          $("#msg").html(
            data + "   " + `<img src="../../images/tick.png" width="20px">`
          );
        } else if (data == "") {
          $("#msg").html(data + "empty");
        }

        $("#myForm")[0].reset();

        showlanguage();
      },

      error: function (data) {
        console.log("function is fail");
      },
    });
  });

  //******************************* ajax function for deleting language ***********************************//
  $("#inside_lan-div").on("click", "#delete_language", function () {
    let id = $(this).attr("data-sid");
    console.log(id);
    mydata = { sid: id };

    $.ajax({
      url: "../../backhend/delete.php",
      type: "POST",
      data: JSON.stringify(mydata),

      success: function (data) {
        // console.log(data);
        alert(data);
        showlanguage();
      },
    });
  });
  // showlanguage();

  //******************************* ajax function for view language ***********************************//
  $("#inside_lan-div").on("click", "#view_language", function () {
    alert("Press ok to view the language");
    let id = $(this).attr("data-sid");
    console.log(id);
    mydata = { sid: id };

    var dataToSend = id;
    var targetPage = "allquestion.html";

    window.location.href =
      targetPage + "?data=" + encodeURIComponent(dataToSend);
  });

  function view() {
    var dataReceived = decodeURIComponent(window.location.search.split("=")[1]);
    let language_id = dataReceived;
    mydata = { id: language_id };
    console.log(mydata);
    $.ajax({
      url: "../../backhend/view.php",
      type: "POST",
      data: JSON.stringify(mydata),

      success: function (data) {
        console.log("function is scucess");
        $("#question-card").html(data);
      },
      error: function () {
        console.log("function is fail");
      },
    });
  }
  // view();

  //*************************************************************************************
  /////////// js for allquestion.html*
  //*************************************************************************************

  //******************************* Toggle to add question ***********************************//
  $("#ques-btn").click(function () {
    document.getElementById("dialog").style.visibility = "visible";
    $("#dialog").toggle();
  });

  //********************************* for add question for in allquestion.html ***********************************//
  $("#add_ques").click(function (e) {
    e.preventDefault();
    let stid = $("#stuid").val();
    let question = $("#input_of_question").val();
    let opt_1 = $("#input_of_option_1").val();
    let opt_2 = $("#input_of_option_2").val();
    let opt_3 = $("#input_of_option_3").val();
    let opt_4 = $("#input_of_option_4").val();
    let ans = $("#input_of_answer").val();
    let id = $("#lang-id").val();
    console.log("button pressed by you");

    questions = {
      hid: stid,
      quest: question,
      option_1: opt_1,
      option_2: opt_2,
      option_3: opt_3,
      option_4: opt_4,
      answer: ans,
      catid: id,
    };
    console.log(questions);

    $.ajax({
      url: "../../backhend/all questions/question_add.php",
      data: JSON.stringify(questions),
      type: "POST",

      success: function (data) {
        console.log(data);
        if (data == "Question added sucessfully") {
          $("#q_add").html(data + "   " + `<img src="../../images/tick.png" width="20px">`);
          $("#msg_q").css("display", "none");
          $("#myForm")[0].reset();

        } else if (data == "Error: Your answer does not match any of the options.") {
          $("#msg_q").html(data);

        } else if (data == "Error: All the input field has to be different.") {
          $("#msg_q").html(data);

        } else if (data == "Fill all field") {
          $("#msg_q").html(data);
        }

        showquestion();
      },

      error: function (data) {
        console.log("function is fail");
      },
    });
  });

  // showquestion();

  //******************************* ajax function for retrive question of html ***********************************//
  function showquestion() {
    let id = $("#lang-id").val();
    mydata = { selectedOptionid: id };
    console.log(mydata);
    $.ajax({
      url: "../../backhend/all questions/retrive_data_Html_question.php",
      type: "POST",
      data: JSON.stringify(mydata),

      success: function (data) {
        console.log("function is scucess");
        console.log(data);
        $("#question-card").html(data);
      },
      error: function () {
        console.log("function is fail");
      },
    });
  }
  // showquestion();
  //******************************* ajax function for deleting question of html ***********************************//
  $("#question-card").on("click", "#del-btn", function () {
    let id = $(this).attr("data-sid");
    console.log(id);
    mydata = { sid: id };

    $.ajax({
      url: "../../backhend/all questions/delete_html_question.php",
      type: "POST",
      data: JSON.stringify(mydata),

      success: function (data) {
        // alert("question delete");
        showquestion();
      },
    });
  });

  //******************************* ajax function for edit question of html ***********************************//
  $("#question-card").on("click", "#edi-btn", function () {
    alert("Press ok to edit the question");
    let id = $(this).attr("data-sid");
    mydata = { question_id: id };
    // console.log(mydata);

    $.ajax({
      url: "../../backhend/all questions/edit_html_question.php",
      type: "POST",
      data: JSON.stringify(mydata),
      dataType: "json",

      success: function (data) {
        // console.log(data);

        // $("#question-card").html(data);
        $("#dialog").toggle();
        $("#stuid").val(data.id);
        $("#input_of_question").val(data.question);
        $("#input_of_option_1").val(data.first_option);
        $("#input_of_option_2").val(data.second_option);
        $("#input_of_option_3").val(data.third_option);
        $("#input_of_option_4").val(data.fourth_option);
        $("#input_of_answer").val(data.answer);
      },
    });
  });

  // ************************    Add language dynamically in allquestion.html ****************************************//
  function addDynamical_catogry() {
    var dataReceived = decodeURIComponent(window.location.search.split("=")[1]);
    let language_id = dataReceived;
    $.ajax({
      url: "../../backhend/retrive_language_option.php",
      type: "GET",
      data:{language_id:language_id},
      success: function (data) {
        $("#option_lan").html(data);
      },
    });
  }
  addDynamical_catogry();

  //******************************* for dropdown to view language question in allquestion.html ***********************************//

  $("#option_lan").change(function () {
    var id = $(this).find(":selected").attr("id");
    mydata = { selectedOptionid: id };
    $("#lang-id").val(id);

    $.ajax({
      url: "../../backhend/all questions/retrive_data_Html_question.php",
      type: "POST",
      data: JSON.stringify(mydata),

      success: function (data) {
        $("#question-card").html(data);
      },
      error: function () {
        alert("error");
      },
    });
  });

  //******************************* js for index.html(main page) for linking div to html file ***********************************//
  $("#lan").click(function () {
    window.location.href = "languages.html";
  });

  //******************************* for linking div to allquestion.html ***********************************//
  $("#question-box").click(function () {
    window.location.href = "allquestion.html";
  });
});





